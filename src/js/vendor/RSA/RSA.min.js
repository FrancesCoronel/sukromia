"use strict";var RSA={};RSA.generate=function(r,n){function t(r,n){var t=0,o=1,e=n,i=r%n;for(n<0&&(n=-n),r<0&&(r=n- -r%n);0!==i;){var a=e/i|0,d=o;o=t-a*o,t=d,d=i,i=e-a*i,e=d}return e>1?-1:(t<0&&(t+=n),t)}if(!r)throw new Error("p has to be provided");if(!n)throw new Error("q has to be provided");var o=r*n,e=(r-1)*(n-1),i=this.random_prime(1,e);return{n:o,e:i,d:t(i,e)}},RSA.random_N_bit_prime=function(r){return this.random_prime(1,Math.pow(2,r)-1)},RSA.random_prime=function(r,n){for(;;){var t=Math.floor(Math.random()*(n-1-r+1))+r;if(!0===bigInt(t).isPrime())return t}},RSA.encrypt=function(r,n,t){return bigInt(r).pow(t).mod(n)},RSA.decrypt=function(r,n,t){return bigInt(r).pow(n).mod(t)};