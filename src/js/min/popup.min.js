chrome.runtime.onMessage.addListener(function(t,e,r){"selectionText"==t.type&&$("#text").val(t.text)}),$(document).ready(function(){function t(){var t="";for(i=0;i<20;i++)t+=String.fromCharCode(Math.floor(33+94*Math.random()));return t}function e(){document.getElementById("text").select(),document.execCommand("copy")}function r(){var t=$.Deferred();return t.resolve("AES"),t.promise()}function n(t){return String.fromCharCode.apply(null,t)}function a(t){for(var e=new Uint8Array(t.length),r=0,n=t.length;r<n;r++)e[r]=t.charCodeAt(r);return e}function o(t){for(var e=new ArrayBuffer(t.sigBytes),r=new Uint8Array(e),n=0;n<t.sigBytes;n++)r[n]=t.words[n>>>2]>>>24-n%4*8&255;return e}function c(t,e,r){var n=CryptoJS.lib.WordArray.create(new Uint8Array(e)),i=CryptoJS[t].encrypt(n,r),c=new Uint8Array(o(i.ciphertext)),s=new Uint8Array(48);s.set(a(i.iv.toString())),s.set(a(i.salt.toString()),32);var y=new ArrayBuffer(c.length+s.length),l=new Uint8Array(y);return l.set(c),l.set(s,c.length),y}function s(t,e,r){var a=new Uint8Array(e,0,e.byteLength-48),i=new Uint8Array(e,e.byteLength-48,32),c=new Uint8Array(e,e.byteLength-48+32,16),s=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.lib.WordArray.create(a),iv:CryptoJS.enc.Hex.parse(n(i)),salt:CryptoJS.enc.Hex.parse(n(c))});return o(CryptoJS[t].decrypt(s,r))}function y(t,e,r){return CryptoJS[t].encrypt(e,r).toString()}function l(t,e,r){return CryptoJS[t].decrypt(e,r).toString(CryptoJS.enc.Utf8)}$("#encrypt").click(function(){$("#text").val().length?r().done(function(t){var r=y(t,$("#text").val(),$("#passphrase").val());$("#text").val(r),e()}):message("Please enter some text to encrypt first.")}),$("#decrypt").click(function(){$("#text").val().length?r().done(function(t){var r=l(t,$("#text").val(),$("#passphrase").val());$("#text").val(r),e()}):message("Please enter text to decrypt first.")}),$("#random").click(function(){$("#passphrase").val(t())}),$("#copy").click(function(){e()}),$("#clear").click(function(){$("#text").val(""),$("#passphrase").val("")})});